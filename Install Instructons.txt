Installation of OpenWRT on Sphere (WE-826) router using QMI
Initial Install
	1.	Flash latest version of OpenWRT to router (current release 21.02.0)
		a.	https://openwrt.org/toh/zbt/we-826
		b.	log into OpenWRT (192.168.1.1) - password is blank
			i.	Change DHCP to 192.168.8.1 - note renew IP address
			ii.	Apply and renew IP address
			iii.	Log back in with new IP address (192.168.8.1)
		c.	System:
			i.	Hostname to "Panavan"	
			ii.	Time to “Australia/Brisbane”
		d.	Administration -Change Router Password
		c.	Network > Wireless > Edit Master
			i.	General setup: Channel: 12, Width: 40MHz, ESSID: Panavan
			ii.	Wireless Security: WPA2-PSK, Key: xxxxxxxx
			iii.	Advance Setting: Country Code: AU
		d.	Enable, Save and Apply
	2.	Clear SSH entry for 192.168.8.1 in ~/.ssh/known-hosts

Install LTE modem in QMI mode
	3.	Instructions at https://openwrt.org/docs/guide-user/network/wan/wwan/ltedongle
		a.	Start Terminal session – “ssh root@192.168.8.1”
			i.	opkg update
			ii.	opkg install usb-modeswitch kmod-mii kmod-usb-net kmod-usb-wdm kmod-usb-net-qmi-wwan uqmi
			iii.	opkg install kmod-usb-serial-option kmod-usb-serial kmod-usb-serial-wwan
			iv.	opkg install luci-proto-qmi
		b.	Reboot
		c.	Check everything is okay (optional):
			i.	Log back into router with SSH
			ii.	ls -l /dev/cdc-wdm0
		d.	Log into LuCi (Browser) - configure the modem using LuCi (Network → Interfaces)
			i.	Add new interface called GSM, Protocol: “QMI Cellular”
			ii.	General Setting: Modem Device: “/dev/cdc-wdm0”, APN: connect, PDP Type: IPv4
			iii.	Firewall Setting: WAN
		e.	Save and Apply

Install Cellular Network Info
	4.	Instructions are at https://forum.openwrt.org/t/cellular-signal-level-indicator/60543/18
		a.	Download luCi program from http://www.rottengatter.de/download/luci-app-qmi-cellstatus_1.0.0_all.ipk
		b.	Copy to model: scp ./luci-app-qmi-cellstatus_1.0.0_all.ipk root@192.168.8.1:/root
		d.	Log into modem and Install: opkg install ./luci-app-qmi-cellstatus_1.0.0_all.ipk
		e.	Restart LuCi interface: /etc/init.d/uhttpd restart

Install iPhone Support:
	5.	Instructions at https://openwrt.org/docs/guide-user/network/wan/smartphone.usb.tethering?s[]=iphone
		a.	start Terminal
			i.	opkg update
			ii.	opkg install kmod-usb-net-ipheth usbmuxd libimobiledevice usbutils
			iii.	usbmuxd -v  				# Call usbmuxd
			iv.	sed -i -e "\$i usbmuxd" /etc/rc.local	# Add usbmuxd to autostart
		b.	Plug in iPhone
			I.	Trust: "Yes"
		c.	Define interface through Luci
			i.	Log into Web interface
			ii.	Network > Interfaces "Add New Interface"
			iii.	General Settings > Name: iPhone; Protocol: "DHCP Client"; Device: "eth1"
			iv.	Firewall Settings: Assign: "wan"

Optional install development applications
	6.	Install various applications for development and debugging
		a.	opkg update
		b.	opkg install openssh-sftp-server. # sftp server for remote editing via BBedit
		c.	opkg install minicom 		# terminal emulator
		d.	opkg install ???

Optional Install Travelmate
	7.	Instructions at https://forum.openwrt.org/t/travelmate-support-thread/5155
		a.	Log into LuCi > System > Software
		b.	Search “travelmate”
		c.	Install “travelmate”
		d.	Install “luci-app-travelmate”
		e.	Reboot
		f.	Log back into LuCi > Services > Travelmate
			i.	Create uplink Interface: wwan
			ii.	Overview: Enable Travelmate
			iii.s	Wireless Stations: Scan Radio, choose suitable Uplink SSID

Install SMS to GPS script (smsgps.sh)
	8.	Install from cd /users/Robert/OneDrive/Caravan/OpenWRT/Sphere/V1-QMI
		a.	Install required coreutils: In LuCi > System > Software
			i.	Install STTY, socat
		b.	In Terminal (mac)
			i.	Copy script to modem: scp ./smsgps.qmi.sh root@192.168.8.1:/root/smsgps.sh
			ii.	Copy Service (procd script) to modem: scp ./smsgps root@192.168.8.1:/etc/init.d/smsgps
			iii.	Copy Config file to modem: scp ./smsgps.conf root@192.168.8.1:/etc/config/smsgps
		c.	Log into Router
			i.	chmod 755 /root/smsgps.sh
			ii.	chmod 755 /etc/init.d/smsgps
			iii.	/etc/init.d/smsgps enable
			iv.	/etc/init.d/smsgps start

Install GPS tracking script (trackgps.sh)
	9.	Install from cd /users/Robert/OneDrive/Caravan/OpenWRT/Sphere/V1-QMI
		a.	Install required coreutils: In LuCi > System > Software
			i.	Install mailsend
		b.	In Terminal (mac)
			i.	Copy script to modem: scp ./trackgps.qmi.sh root@192.168.8.1:/root/trackgps.sh
			ii.	Copy Service (procd script) to modem: scp ./trackgps root@192.168.8.1:/etc/init.d/trackgps
		c.	Log into Router
			i.	chmod 755 /root/trackgps.sh
			ii.	chmod 755 /etc/init.d/trackgps
			iii.	/etc/init.d/trackgps enable


Notes:
AT+QCFG="usbnet"   - shows current mode
AT+QCFG="usbnet",0 - is PPP & QMI (default)
AT+QCFG="usbnet",1 - is ECM
AT+QCFG="usbnet",2 - is MBIM
AT+CFUN=1,1        - reboot QE25

uqmi -d /dev/cdc-wdm0 --get-data-status  - QMI status


/etc/init.d/uhttpd restart  - restart Luci


		
		
